{"version":3,"sources":["read.js"],"names":[],"mappings":"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","file":"read-compiled.js","sourcesContent":["\nmodule.exports = read\n\nvar readline = require('readline')\nvar Mute = require('mute-stream')\n\nfunction read (opts, cb) {\n  if (opts.num) {\n    throw new Error('read() no longer accepts a char number limit')\n  }\n\n  if (typeof opts.default !== 'undefined' &&\n      typeof opts.default !== 'string' &&\n      typeof opts.default !== 'number') {\n    throw new Error('default value must be string or number')\n  }\n\n  var input = opts.input || process.stdin\n  var output = opts.output || process.stdout\n  var prompt = (opts.prompt || '').trim() + ' '\n  var silent = opts.silent\n  var editDef = false\n  var timeout = opts.timeout\n\n  var def = opts.default || ''\n  if (def) {\n    if (silent) {\n      prompt += '(<default hidden>) '\n    } else if (opts.edit) {\n      editDef = true\n    } else {\n      prompt += '(' + def + ') '\n    }\n  }\n  var terminal = !!(opts.terminal || output.isTTY)\n\n  var m = new Mute({ replace: opts.replace, prompt: prompt })\n  m.pipe(output, {end: false})\n  output = m\n  var rlOpts = { input: input, output: output, terminal: terminal }\n\n  if (process.version.match(/^v0\\.6/)) {\n    var rl = readline.createInterface(rlOpts.input, rlOpts.output)\n  } else {\n    var rl = readline.createInterface(rlOpts)\n  }\n\n\n  output.unmute()\n  rl.setPrompt(prompt)\n  rl.prompt()\n  if (silent) {\n    output.mute()\n  } else if (editDef) {\n    rl.line = def\n    rl.cursor = def.length\n    rl._refreshLine()\n  }\n\n  var called = false\n  rl.on('line', onLine)\n  rl.on('error', onError)\n\n  rl.on('SIGINT', function () {\n    rl.close()\n    onError(new Error('canceled'))\n  })\n\n  var timer\n  if (timeout) {\n    timer = setTimeout(function () {\n      onError(new Error('timed out'))\n    }, timeout)\n  }\n\n  function done () {\n    called = true\n    rl.close()\n\n    if (process.version.match(/^v0\\.6/)) {\n      rl.input.removeAllListeners('data')\n      rl.input.removeAllListeners('keypress')\n      rl.input.pause()\n    }\n\n    clearTimeout(timer)\n    output.mute()\n    output.end()\n  }\n\n  function onError (er) {\n    if (called) return\n    done()\n    return cb(er)\n  }\n\n  function onLine (line) {\n    if (called) return\n    if (silent && terminal) {\n      output.unmute()\n      output.write('\\r\\n')\n    }\n    done()\n    // truncate the \\n at the end.\n    line = line.replace(/\\r?\\n$/, '')\n    var isDefault = !!(editDef && line === def)\n    if (def && !line) {\n      isDefault = true\n      line = def\n    }\n    cb(null, line, isDefault)\n  }\n}\n"]}